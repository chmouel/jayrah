# OpenShift Pipelines CVE Component Mapping Guide

This guide helps the security team properly categorize CVE issues by component in Jira (SRVKP project).

## Quick Reference

When creating or updating a CVE issue:
1. Identify the container image or package name from the CVE
2. Match it against the patterns below
3. Set the Jira **Component** field accordingly
4. Add the **security** label

---

## Component Mapping Table

| Component | Image/Package Patterns | Repository |
|-----------|------------------------|------------|
| **UI** | `pipelines-console-plugin`<br>`console-plugin` | OpenShift Pipelines Console Plugin |
| **Pipelines as Code** | `pipelines-as-code`<br>`pipelines-pipelines-as-code`<br>`pac-controller`<br>`pac-webhook`<br>`pac-watcher` | Pipelines as Code (PAC) |
| **Tekton Chains** | `pipelines-chains`<br>`chains-controller` | Tekton Chains |
| **Tekton Hub** | `pipelines-hub`<br>`tekton-hub` | Tekton Hub |
| **Tekton Triggers** | `pipelines-triggers`<br>`triggers-controller`<br>`triggers-webhook`<br>`triggers-eventlistenersink`<br>`triggers-core-interceptors` | Tekton Triggers |
| **Tekton Results** | `pipelines-results`<br>`tekton-results`<br>`results-api`<br>`results-watcher` | Tekton Results |
| **Manual Approval** | `pipelines-manual-approval`<br>`manual-approval-gate` | Manual Approval Gate |
| **Pruner** | `pipelines-tektoncd-pruner`<br>`pruner-controller`<br>`pruner-webhook` | Tekton Pruner |
| **Tekton Pipelines** | `pipelines-controller`<br>`pipelines-webhook`<br>`pipelines-resolvers`<br>`pipelines-entrypoint`<br>`pipelines-git-init`<br>`pipelines-workingdirinit`<br>`pipelines-nop`<br>`pipelines-sidecarlogresults`<br>`pipelines-events`<br>`pipelines-cache` | Tekton Pipelines Core |
| **Operator** | `pipelines-rhel9-operator`<br>`pipelines-operator-proxy`<br>`pipelines-operator-webhook` | OpenShift Pipelines Operator |
| **Tekton CLI** | `pipelines-cli`<br>`pipelines-serve-tkn`<br>`openshift-pipelines-client` | Tekton CLI (tkn) |

---

## Examples

### Example 1: Console Plugin CVE
**CVE Summary**: `cve-2024-12345 in registry.redhat.io/openshift-pipelines/pipelines-console-plugin-rhel9`

**Affected image**: `pipelines-console-plugin-rhel9`

**Component to set**: `UI`

---

### Example 2: Pipelines as Code CVE
**CVE Summary**: `cve-2024-23456 affecting pipelines-pipelines-as-code-controller`

**Affected image**: `pipelines-pipelines-as-code`

**Component to set**: `Pipelines as Code`

---

### Example 3: Tekton Pipelines Controller CVE
**CVE Summary**: `cve-2024-34567 in openshift-pipelines/pipelines-controller-rhel9`

**Affected image**: `pipelines-controller`

**Component to set**: `Tekton Pipelines`

---

### Example 4: Multiple Components
If a CVE affects multiple images from different components, create **separate issues** for each component.

---

## How to Use This Guide

### When creating a new CVE issue:

1. **Extract the image name** from the CVE notification
   - Example: `registry.redhat.io/openshift-pipelines/pipelines-chains-controller-rhel9:v1.2.3`
   - Image name: `pipelines-chains-controller`

2. **Match against patterns** in the table above
   - `pipelines-chains` matches â†’ Component: **Tekton Chains**

3. **Set in Jira**:
   - Project: `SRVKP`
   - Component: `Tekton Chains`
   - Labels: `security`
   - Summary: `cve-XXXX-YYYY in [image-name]`

### Pattern Matching Tips:

- Patterns are **case-insensitive**
- Patterns match **partial strings** (substring match)
- Example: `pipelines-console-plugin-rhel9` matches pattern `console-plugin`
- If multiple patterns could match, choose the **most specific** component

### If no pattern matches:

1. Check the CVE description for package/dependency information
2. Contact the team lead for guidance
3. Leave component **empty** - the triage tool can suggest via AI

---

## CVE Triage Tool

The team uses an automated triage tool that:
- Detects miscategorized issues using these patterns
- Suggests correct components using AI (Gemini) when patterns don't match
- Can auto-fix issues with high confidence suggestions

### Tool usage:
```bash
# List miscategorized issues
./cve_triage.py list

# Check specific issue
./cve_triage.py check SRVKP-12345

# Interactive triage session
./cve_triage.py triage

# Generate report
./cve_triage.py report
```

---

## Contact

If you're unsure about component assignment:
- Run the triage tool for AI suggestions
- Ask in #openshift-pipelines-dev
- Leave component empty and let the automation handle it

---

## Updates

This mapping is maintained in: `jayrah/tools/cve-triage/config.yaml`

To add new patterns or components, update the config file and notify the team.
